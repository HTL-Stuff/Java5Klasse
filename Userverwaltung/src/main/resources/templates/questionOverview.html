<!DOCTYPE html>
<html lang="en" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Question Overview</title>
</head>
<body sec:authorize="isAuthenticated()">
<div style="display: inline-block">
    <div style="display: inline-block">Logged in as</div>
    <div style="display: inline-block" th:text="${user.username}"></div>
    <div style="display: inline-block"> |</div>
    <a href="/logout" style="display: inline-block">Logout</a>
</div>

<table th:if="${questions.size()} > 0">
    <tr>
        <th>Title</th>
        <th>Expiry Date</th>
        <th sec:authorize="hasRole('ROLE_ADMIN')" th:each="type : ${answerTypes}" th:name="typeHeader"
            th:text="${type.name()}"></th>
    </tr>
    <tr th:each="question : ${questions}">
        <td th:text="${question.getName()}"></td>
        <td th:text="${question.getExpiryDate()}"></td>
        <td sec:authorize="hasRole('ROLE_ADMIN')" th:name="distribution"
            th:with="temp=${T(at.noahb.userverwaltung.util.FilterMap).filter(distribution.stream(), question.getId())}">
            <div style="display: inline-block" th:each="answerDistribution : ${temp}"
                 th:text="${answerDistribution.getCount()}"></div>
        </td>
        <td><a th:href="@{/questions/{id}(id=${question.getId()})}">Details</a></td>
    </tr>
</table>
<div th:if="${questions.size()} == 0">No new Questions</div>
<a href="/questions" id="new" sec:authorize="hasRole('ROLE_ADMIN')">new</a>
</body>
</html>