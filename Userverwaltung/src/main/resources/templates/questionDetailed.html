<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Question</title>
</head>
<body>
<div style="display: inline-block">
    <div style="display: inline-block">Logged in as</div>
    <div th:text="${user.username}" style="display: inline-block"></div>
    <div style="display: inline-block"> |</div>
    <a href="/logout" style="display: inline-block">Logout</a>
</div>

<h1 th:text="${question.getName()}"></h1>
<p th:text="${question.getQuestion()}"></p>
<p th:text="${question.getExpiryDate()}"></p>
<form id="giveAnswer" th:object="${answer}" method="post" th:action="@{/questions/{id}/update (id=${question.getId()})}">
    <div th:each="answerType : ${answerTypes}">
        <label th:for="'questionAnswer_' + ${answerType.name()}"></label>
        <input type="radio" th:id="'questionAnswer_' + ${answerType.name()}" name="answerType" th:text="${answerType.name()}"
               th:value="${answerType.name()}" th:field="*{answerType}">
    </div>
    <input id="submit" type="submit" value="Submit Answer">
</form>

<div id="answers">
    Answers:
</div>
<br>
<a href="/questions">Back to overview</a>
</body>
<script th:inline="javascript">
    const role = /*[[${role}]]*/ 'ROLE_USER';
    if (role === 'ROLE_ADMIN') {
        document.getElementById("giveAnswer").setAttribute("hidden", "hidden");
        document.getElementById("answers").removeAttribute("hidden");
    }

    if (role === 'ROLE_USER') {
        document.getElementById("answers").setAttribute("hidden","hidden");
        document.getElementById("giveAnswer").removeAttribute("hidden");
    }

    const answer = [[${answer}]];

    console.log(answer)

    if (answer !== null) {
        document.getElementById("questionAnswer_" + answer.answerType).setAttribute("checked", "checked");
        document.getElementsByName("questionAnswer").forEach(function (element) {
            element.setAttribute("disabled", "disabled");
        });
        document.getElementById("submit").setAttribute("disabled", "disabled");
    }
</script>
</html>